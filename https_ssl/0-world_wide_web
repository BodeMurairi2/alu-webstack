#!/usr/bin/env bash
# Script to display DNS information about subdomains

# Function to perform DNS query and format output
get_subdomain_info() {
    local domain=$1
    local subdomain=$2
    local full_domain="${subdomain}.${domain}"

    # Perform dig and extract relevant info
    local record=$(dig $full_domain | grep -A1 "ANSWER SECTION:" | tail -n1)

    # Use awk to parse the info
    echo "$record" | awk -v sub="$subdomain" '
    {
        if (NF >= 5) {
            printf "The subdomain %s is a %s record and points to %s\n", sub, $4, $5
        }
    }'
}

# Main script logic
domain=$1
subdomain=$2

# Check if only domain is provided
if [ -z "$subdomain" ]; then
    for sub in www lb-01 web-01 web-02; do
        get_subdomain_info $domain $sub
    done
else
    get_subdomain_info $domain $subdomain
fi
